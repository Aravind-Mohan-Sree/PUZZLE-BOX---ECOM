<!-- ------------------------------- styles -------------------------------- -->
<style>
  .product-detail-container {
    flex-grow: 1;
    padding-top: 7.25rem;
    padding-bottom: 2.875rem;
  }

  .main-image {
    cursor: crosshair;
    transition: transform 0.1s linear;
  }

  .main-image:hover {
    transform: scale(3);
  }

  .sub-image {
    cursor: pointer;
  }

  /* Style the tab */
  .tab {
    overflow: hidden;
    background-color: #ffffff;
  }

  /* Style the tab content */
  .tabcontent {
    display: none;
    padding: 2rem;
    margin-top: 1.25rem;
    border: 1px solid #cccccc63;
    border-radius: 10px;
  }
</style>
<!-- ----------------------------------------------------------------------- -->

<!-- --------------------------- navbar included --------------------------- -->
<%- include('navbar') %>
<!-- ----------------------------------------------------------------------- -->

<!-- ---------------------- product detail container ----------------------- -->
<div class="product-detail-container">
  <!-- ----------------------- product highlight section ------------------------ -->
  <section>
    <div class="container px-4 px-sm-2">
      <div class="row">
        <div class="col-4">
          <div class="rounded-9 main-image-container overflow-hidden">
            <img src="<%= product.productImage[0] %>" class="img-fluid rounded-9 main-image" />
          </div>
          <div class="row justify-content-evenly mt-3 sub-images">
            <div class="col-4">
              <img src="<%= product.productImage[1] %>" class="img-fluid rounded-7 sub-image" />
            </div>
            <div class="col-4">
              <img src="<%= product.productImage[2] %>" class="img-fluid rounded-7 sub-image" />
            </div>
          </div>
        </div>
        <div class="col offset-1">
          <h2 class="text-dark">
            <%= product.productName %>
            <i class="fa-duotone fa-solid fa-heart-circle-plus ms-5" style="--fa-primary-color: #000000; --fa-secondary-color: #ff0000; --fa-secondary-opacity: 1;"></i>
          </h2>
          <div class="col text-warning mt-3 mb-4">
            <i class="fa fa-star"></i>
            <i class="fa fa-star"></i>
            <i class="fa fa-star"></i>
            <i class="fa fa-star-half-stroke"></i>
            <i class="fa-light fa-star"></i>
            <strong class="text-dark ms-3"><span>3.5</span>/5</strong>
          </div>
          <h3 class="mb-4 mt-3">
            <s class="text-danger"><%= product.productDiscount !== 0 ? '₹ ' + product.productPrice : '' %></s><strong class="<%= product.productDiscount !== 0 ? 'ms-2' : '' %> text-dark">₹ <%= product.productDiscountedPrice %></strong>
            </span><span class="badge badge-danger ms-3 p"><%= product.productDiscount !== 0 ? '-' + product.productDiscount + '%' : '' %></span>
          </h3>
          <h6>Availability - <span class="badge <%= product.productQuantity <= 10 ? 'badge-warning' : 'badge-success' %>"><%= product.productQuantity <= 10 ? 'Only ' + product.productQuantity + ' left' : 'In stock' %></span></h6>
          <h4 class="mt-5 mb-3 text-decoration-underline">Description</h4>
          <p class=""><%= product.productDescription %></p>
          <div class="row mt-5">
            <div class="col-3">
              <div class="input-group">
                <button class="btn btn-dark"><i class="fa-regular fa-minus"></i></button>
                <input type="text" class="form-control text-center fw-semibold" aria-label="" value="1" disabled />
                <button class="btn btn-dark"><i class="fa-regular fa-plus"></i></button>
              </div>
            </div>
            <div class="col">
              <button class="btn btn-block btn-dark"><i class="fa-regular fa-cart-shopping fa-bounce me-3" style="color: #ffffff;"></i>add to cart</button>
            </div>
          </div>
        </div>
      </div>
    </div>
  </section>
  <!-- ----------------------------------------------------------------------- -->

  <!-- ------------------------------- divider ------------------------------- -->
  <hr class="container mt-5">
  <!-- ----------------------------------------------------------------------- -->

  <!-- --------------- product description and review section ---------------- -->
  <section>
    <div class="container px-4 px-sm-2">
      <div class="row px-3">
        <div class="tab px-0 mt-4">
          <button class="tablinks btn btn-dark me-3" onclick="tab(event, 'details')">Details</button>
          <button class="tablinks btn btn-dark" onclick="tab(event, 'reviews')">Ratings & Reviews</button>
        </div>

        <div id="details" class="tabcontent">
          <h3>London</h3>
          <p>London is the capital city of England.</p>
        </div>

        <div id="reviews" class="tabcontent">
          <h3>Paris</h3>
          <p>Paris is the capital of France.</p>
        </div>
      </div>
    </div>
  </section>
  <!-- ----------------------------------------------------------------------- -->
</div>
<!-- ----------------------------------------------------------------------- -->

<!-- ----------------------------- javaScript ------------------------------ -->
<script>
  // after redirection, remove the query parameter from the URL
  // window.history.replaceState(null, null, window.location.pathname);

  document.addEventListener("DOMContentLoaded", function() {
    // for product image swapping on hover
    const mainImageContainer = document.querySelector(".main-image-container");
    const mainImage = document.querySelector(".main-image");
    const subImages = document.querySelectorAll(".sub-image");

    subImages.forEach(subImage => {
      subImage.addEventListener("mouseenter", function() {
        // Swap the main image with the hovered sub-image
        const tempSrc1 = mainImage.src;
        mainImage.src = this.src;
        this.src = tempSrc1;
      });
    });

    // zoom and move the product image with the mouse
    mainImageContainer.addEventListener('mousemove', (e) => {
      const {
        left,
        top,
        width,
        height
      } = mainImageContainer.getBoundingClientRect();
      const x = (e.clientX - left) / width;
      const y = (e.clientY - top) / height;

      mainImage.style.transformOrigin = `${x * 100}% ${y * 100}%`;
    });
  });

  // for searching products
  document.addEventListener('DOMContentLoaded', function() {
    const searchButton = document.getElementById('search-button');

    searchButton.addEventListener('click', function() {
      const searchTerm = document.getElementById('search-input').value;

      window.location.href = `/products?searchTerm=${searchTerm}`;
    });
  });

  // funtion for tab functionality
  function tab(evt, tabName) {
    let i, tabcontent, tablinks;
    tabcontent = document.getElementsByClassName("tabcontent");

    for (i = 0; i < tabcontent.length; i++) {
      tabcontent[i].style.display = "none";
    }

    tablinks = document.getElementsByClassName("tablinks");

    for (i = 0; i < tablinks.length; i++) {
      tablinks[i].className = tablinks[i].className.replace(" active", "");
    }

    document.getElementById(tabName).style.display = "block";
    evt.currentTarget.className += " active";
  }
</script>
<!-- ----------------------------------------------------------------------- -->